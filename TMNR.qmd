---
title: "TMNR"
author: "Belize Analytics"
format: 
  html:
    theme: zephyr
    page-layout: article
    toc: true
    toc-depth: 4
editor: visual
---

## TMNR Base Analysis

```{r}
#| include: false
#| label: libraries

# load libraries
library(dplyr)
library(tidyr)
library(haven)
library(ggplot2)
library(stringr)
library(janitor)
library(DBI)
library(gt)
library(HH)

select <- dplyr::select

# for modifying text size in charts

gg_text_charts <- theme(
  text = element_text(size = 15)
)

# theme for charts where we want to remove x-axis labels and lines

gg_blank_x <- theme_bw() +
  theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.border = element_blank()
  )

# theme for charts where we want to remove y-axis labels and lines

gg_blank_y <- theme_bw() +
  theme(
    panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks.y = element_blank(),
    panel.border = element_blank()
  )

```

```{r}
#| include: false
#| label: load-data

# interview keys of questionnaires to ignore/exclude

ignore_qs <- c('79-84-83-57',
               '30-26-25-41',
               '66-59-17-95',
               '92-56-91-59',
               '70-81-50-38',
               '17-39-72-74'
               )

# import base (household) file, change CTVs to use factor labels, 
# filter out questionnaires to ignore

base <- read_sav('./KARST_FILES/tmnr.sav') |> 
  mutate(
    ctv = as_factor(ctv),
    strata = case_when(
      ctv %in% c('El Progress (7 Miles)/Upper Barton Creek', 
                 'Lower Barton Creek/New Holland/East Land') ~ 'Mennonite',
      TRUE ~ 'Non-Mennonite'
    )
  ) |> 
  filter(
    !interview__key %in% ignore_qs
  )

# extract cover-page variables from the base file
# these will later be merged to other child datasets

base_vars <- base |> 
  select(interview__key, 
         ctv, 
         strata,
         ed, 
         building_number, 
         household_number, 
         dwelling_number, 
         result) 

# import member listing dataset

listing <- read_sav('./KARST_FILES/listingRoster.sav')

# merge cover variables to the listing data 

listing <- base_vars |> 
  left_join(
    listing,
    by = c('interview__key')
  ) 

# import k2 roster dataset

k2 <- read_sav('./KARST_FILES/k2_roster.sav') 

# merge cover variables to the k2 dataset

k2 <- base_vars |> 
  left_join(
    k2, 
    by = c('interview__key')
  )


# import sample file and fix/standardize ctv variable to match
# the ctv names in the actual dataset

ksample <- readxl::read_excel('./ksample2.xlsx') |> 
  select(interview_key, 
         ed, 
         head_name,
         ctv_official, 
         building_number, 
         dwelling_number, 
         household_number,
         GPS_Building_Navig__Latitude,
         GPS_Building_Navig__Longitude
         ) |> 
  mutate(
    ctv = case_when(
      ctv_official == 'Lower Barton Creek' ~ 'Lower Barton Creek/New Holland/East Land',
      ctv_official == 'Upper Barton Creek' ~ 'El Progress (7 Miles)/Upper Barton Creek',
      TRUE ~ ctv_official
    )
  )


```

```{r}
#| include: false
#| label: extra-prep

# derive respondent datasets

households <- base |> 
  filter(result == 1)

listing <- listing |> 
  filter(result == 1)

k2 <- k2 |> 
  filter(result == 1)

# add age group variable

listing <- listing |>  
  mutate(
    age_group = case_when(
      age >= 50 ~ '50+',
      age %in% 35:49 ~ '35-49',
      age %in% 18:34 ~ '18-34',
      age %in% 5:17 ~ '5-17',
      age %in% 0:15 ~ '0-4'
    )
  ) 

# fix the factor-levels of the age-group variable

listing$age_group <- factor(listing$age_group, levels = c(
                                                  '0-4',
                                                  '5-17',
                                                  '18-34',
                                                  '35-49',
                                                  '50+'
                                                ))

# simplify ethnicity groups

listing <- listing |> 
  mutate(
    ethnicity = as_factor(ethnicity)
  ) |> 
  mutate(
    ethnicity_group = case_when(
      ethnicity %in% c('Mestizo/Hispanic/Latino', 'Creole', 'Mennonite') ~ 
        as.character(ethnicity),
      TRUE ~ 'Other'
    )
  ) 

# add educational attainment level

listing <- listing |> 
  mutate(
    ed_attainment = case_when(
      ed_attending == 1 & ed_clevel %in% 0:8 ~ 'None/Some Primary',
      ed_attending == 1 & ed_clevel %in% 9:12 ~ 'Primary',
      ed_attending == 1 & ed_clevel %in% 17 ~ 'Secondary',
      ed_attending == 1 & ed_clevel %in% 18:19 ~ 'Tertiary',
      ed_attending == 2 & ed_llevel %in% 0:7 ~ 'None/Some Primary',
      ed_attending == 2 & ed_llevel %in% 8:11 ~ 'Primary',
      ed_attending == 2 & ed_llevel %in% 12 ~ 'Secondary',
      ed_attending == 2 & ed_llevel %in% 17:19 ~ 'Tertiary',
      ed_llevel == 21 ~ 'Never Attended',
      ed_llevel == 20 ~ 'None/Some Primary',
      ed_llevel == 999999 | ed_clevel == 999999 ~ 'Not Stated',
      !is.na(ed_attending) ~ 'Other'
    )
  )

# fix factor levels for ed attainment variables

listing$ed_attainment <- factor(listing$ed_attainment, 
                                levels = c('Primary',
                                           'Secondary',
                                           'Tertiary',
                                           'None/Some Primary',
                                           'Never Attended',
                                           'Not Stated'))


# simplify employment groups

listing <- listing |> 
  mutate(
    workertype_group = case_when(
      workertype %in% 1:2 ~ 'Self Employed',
      workertype %in% 3:4 ~ 'Employee',
      workertype %in% 5:888888 ~ 'Other',
      workertype == 999999 ~ 'Not Stated',
      employed == 2 ~ 'Not Employed'
    )
  ) 


# fix factor levels for worker type variables

listing$workertype_group <- factor(listing$workertype_group, 
                                levels = c('Employee',
                                           'Self Employed',
                                           'Other',
                                           'Not Employed',
                                           'Not Stated'))

# extract HH head demographic variables to merge with household data

listing_head_vars <- listing |> 
  filter(rel == 1) |> 
  select(interview__key, 
         ctv,
         sex,
         age_group,
         ethnicity_group,
         ed_attainment, 
         employed,
         workertype_group)

# merge variables back with HH data
households <- households |> 
  left_join(
    listing_head_vars,
    by = c('interview__key')
  )

k2 <- k2 |> 
  left_join(
    listing_head_vars,
    by = c('interview__key')
  ) |> 
      mutate(
      education = case_when(
        ed_attainment == 'Primary' ~ 'Primary',
        ed_attainment %in% c('Secondary', 'Tertiary') ~ 'Secondary or Higher',
        TRUE ~ 'Other'
      ),
      ethnicity = case_when(
        ethnicity_group %in% 
          c('Creole', 'Mestizo/Hispanic/Latino') ~ ethnicity_group,
        TRUE ~ 'Other'
      )
    )


households <- households |> 
    mutate(
      education = case_when(
        ed_attainment == 'Primary' ~ 'Primary',
        ed_attainment %in% c('Secondary', 'Tertiary') ~ 'Secondary or Higher',
        TRUE ~ 'Other'
      ),
      ethnicity = case_when(
        ethnicity_group %in% 
          c('Creole', 'Mestizo/Hispanic/Latino') ~ ethnicity_group,
        TRUE ~ 'Other'
      )
    )

## add weights
kweights <- readr::read_csv('./karst_weights.csv')

listing <- listing |> 
  left_join(
    kweights,
    by = c('interview__key')
  )


households <- households |> 
  left_join(
    kweights,
    by = c('interview__key')
  )



k2 <- k2 |> 
  left_join(
    kweights,
    by = c('interview__key')
  )
```

```{r}
#| include: false
#| label: export-datasets

# write_sav(households, './respondent/households.sav')
# write_sav(listing, './respondent/members.sav')
# write_sav(k2, './respondent/k2.sav')
```

## Basic Descriptives

Survey results.

```{r}
#| echo: false

# A tables ---------

# SAMPLE frequencies, by CTV and ED

sample_ctv <- ksample |> 
  count(ctv) |> 
  rename(
    Sampled = n
  )

sample_ed <- ksample |> 
  count(ctv, ed) |> 
  rename(
    Sampled = n
  )

# SUBMITTED QUESTIONNAIRE frequencies

submitted_ctv <- base |> 
  count(ctv) |> 
    rename(
    Submitted = n
  )

submitted_ed <- base |> 
  count(ctv, ed) |> 
    rename(
    Submitted = n
  )

# COMPLETED QUESTIONNAIRE frequencies

completed_ctv <- base |> 
  filter(result == 1) |> 
  count(ctv) |> 
    rename(
    Completed = n
  )

completed_ed <- base |> 
  filter(result == 1) |> 
  count(ctv, ed) |> 
    rename(
    Completed = n
  )

# MERGE CTV-level frequencies

df_ctv <- sample_ctv |> 
  left_join(
    submitted_ctv, 
    by = c('ctv')
  ) |> 
  left_join(
    completed_ctv,
    by = c('ctv')
  ) 
  

# MERGE ED-level frequencies

df_ed <- sample_ed |> 
  left_join(
    submitted_ed, 
    by = c('ctv', 'ed')
  ) |> 
  left_join(
    completed_ed,
    by = c('ctv', 'ed')
  ) 
  
# derive totals at the national level

df_all <- df_ctv |> 
  summarise(
    Sampled = sum(Sampled),
    Submitted = sum(Submitted),
    Completed = sum(Completed),
    `Completed %` = paste0(((Completed/Sampled) * 100) |> round(), '%')
  ) |> 
  mutate(
    ctv = 'All',
    ed = 'All',
    .before = 'Sampled'
  )


```

::: panel-tabset
### Community

```{r}
#| echo: false

df_ctv <- df_ctv |> 
  mutate(
    `Completed %` = paste0(((Completed/Sampled) * 100) |> round(1), '%')
  ) |> 
  rbind(df_all |> select(-ed))


df_ctv |> gt()

downloadthis::download_this(
  df_ctv,
  output_name = 'submitted_ctv',
  output_extension = '.xlsx',
  button_label = 'Download'
)

```

### ED

```{r}
#| echo: false

df_ed <- df_ed |> 
    mutate(
    `Completed %` = paste0(((Completed/Sampled) * 100) |> round(1), '%')
  ) |> 
    rbind(df_all)

df_ed |> gt()

downloadthis::download_this(
  df_ed,
  output_name = 'submitted_ed',
  output_extension = '.xlsx',
  button_label = 'Download'
)
```
:::

Characteristics of respondents

```{r}
#| echo: false
#| warning: false

# derive tabulations for basic demographic variables
# for ALL individuals

ind_ages <- listing |> 
  tabyl(age_group, show_missing_levels = F) |> 
  select(Item = age_group, Count = n, Percent = percent)

ind_sex <- listing |> 
  mutate(sex = as_factor(sex)) |> 
  tabyl(sex, show_missing_levels = F) |> 
  select(Item = sex, Count = n, Percent = percent)

ind_community <- listing |> 
  tabyl(ctv, show_missing_levels = F) |> 
  select(Item = ctv, Count = n, Percent = percent)

ind_ethnicity <- listing |> 
  tabyl(ethnicity_group, show_missing_levels = F) |> 
  select(Item = ethnicity_group, Count = n, Percent = percent)

ind_education <- listing |> 
  tabyl(ed_attainment, show_missing_levels = F) |> 
  select(Item = ed_attainment, Count = n, Percent = percent)

ind_employment <- listing |> 
  mutate(employed = as_factor(employed)) |> 
  tabyl(employed, show_missing_levels = F) |> 
  select(Item = employed, Count = n, Percent = percent)

ind_worker <- listing |> 
  tabyl(workertype_group, show_missing_levels = F) |> 
  select(Item = workertype_group, Count = n, Percent = percent)

ind_descriptives <- 
  rbind(ind_sex, 
        ind_ages, 
        ind_ethnicity, 
        ind_education,
        ind_employment,
        ind_worker,
        ind_community
        ) |> 
  mutate(
    Percent = paste0(round(Percent*100,1), '%')
  )


all_ind_descriptives <- ind_descriptives |> 
  gt(rowname_col = "Item") |>
  tab_row_group(
    label = md("**Community**"),
    rows = 27:33
  ) |> 
  tab_row_group(
    label = md("**Worker Type**"),
    rows = 22:26
  )  |> 
  tab_row_group(
    label = md("**Employed**"),
    rows = 19:21
  ) |> 
  tab_row_group(
    label = md("**Highest Education Completed**"),
    rows = 12:18
  ) |> 
  tab_row_group(
    label = md("**Ethnicity**"),
    rows = 8:11
  ) |> 
  tab_row_group(
    label = md("**Age Group**"),
    rows = 3:7
  ) |> 
  tab_row_group(
    label = md("**Sex**"),
    rows = 1:2
  ) |> 
  cols_align(
  align = 'left',
  columns = c('Item')
) |> 
      tab_style(
        style = cell_text(align = "left", indent = px(20)),
        locations = cells_stub()
    )

# derive tabulations for basic demographic variables
# for HH HEAD ONLY

ind_ages <- listing_head_vars |> 
  tabyl(age_group, show_missing_levels = F) |> 
  select(Item = age_group, Count = n, Percent = percent)

ind_sex <- listing_head_vars |> 
  mutate(sex = as_factor(sex)) |> 
  tabyl(sex, show_missing_levels = F) |> 
  select(Item = sex, Count = n, Percent = percent)

ind_community <- listing_head_vars |> 
  tabyl(ctv, show_missing_levels = F) |> 
  select(Item = ctv, Count = n, Percent = percent)

ind_ethnicity <- listing_head_vars |> 
  tabyl(ethnicity_group, show_missing_levels = F) |> 
  select(Item = ethnicity_group, Count = n, Percent = percent)

ind_education <- listing_head_vars |> 
  tabyl(ed_attainment, show_missing_levels = F) |> 
  select(Item = ed_attainment, Count = n, Percent = percent)

ind_employment <- listing_head_vars |> 
  mutate(employed = as_factor(employed)) |> 
  tabyl(employed, show_missing_levels = F) |> 
  select(Item = employed, Count = n, Percent = percent)

ind_worker <- listing_head_vars |> 
  tabyl(workertype_group, show_missing_levels = F) |> 
  select(Item = workertype_group, Count = n, Percent = percent)

head_descriptives <- 
  rbind(ind_sex, 
        ind_ages, 
        ind_ethnicity, 
        ind_education,
        ind_employment,
        ind_worker,
        ind_community
        ) |> 
  mutate(
    Percent = paste0(round(Percent*100,1), '%')
  )


head_ind_descriptives <- head_descriptives |> 
  gt(rowname_col = "Item") |>
  tab_row_group(
    label = md("**Community**"),
    rows = 22:28
  ) |> 
  tab_row_group(
    label = md("**Worker Type**"),
    rows = 19:21
  )  |> 
  tab_row_group(
    label = md("**Employed**"),
    rows = 17:18
  ) |> 
  tab_row_group(
    label = md("**Highest Education Completed**"),
    rows = 10:16
  ) |> 
  tab_row_group(
    label = md("**Ethnicity**"),
    rows = 6:9
  ) |> 
  tab_row_group(
    label = md("**Age Group**"),
    rows = 3:5
  ) |> 
  tab_row_group(
    label = md("**Sex**"),
    rows = 1:2
  ) |> 
  cols_align(
  align = 'left',
  columns = c('Item')
) |> 
      tab_style(
        style = cell_text(align = "left", indent = px(20)),
        locations = cells_stub()
    )

```

::: panel-tabset
### Household Heads

```{r}
#| echo: false
#| label: descriptives-all

head_ind_descriptives |> 
  tab_header(
    title = "Characterstics of Household Heads"
  )

downloadthis::download_this(
  head_descriptives,
  output_name = 'head_descriptives',
  output_extension = '.xlsx',
  button_label = 'Download'
)

```

### All Individuals

```{r}
#| echo: false
#| label: descriptives-head


all_ind_descriptives |> 
  tab_header(
    title = "Characterstics of Individuals"
  )

downloadthis::download_this(
  ind_descriptives,
  output_name = 'ind_descriptives',
  output_extension = '.xlsx',
  button_label = 'Download'
)

```
:::

## KNOWLEDGE Area

```{r}
#| include: false
#| label: tabulation-preparation

# households <- 
#   households |> 
#   mutate(
#     k1 = as_factor(k1),
#     k3 = as_factor(k3),
#     k3_1 = as_factor(k3_1),
#   )

households <- 
  households |> as_factor()

# variables to use in crosstab analyses

anal_vars <- c('strata', 'age_group', 'ethnicity', 'education', 'workertype_group')

# function to tabulation a specified variable

ct_single_helper <- function(row, col, format = 'pct'){
  
  households |> 
    count(!!as.name(row), !!as.name(col), wt = ind_weights) |>
    group_by(!!as.name(row)) |>
    mutate(total = sum(n)) |>
    ungroup() |>
    mutate(
      prop = n/total,
      pct = paste0(round(prop * 100, 1), '%')
    ) |>
    mutate(
      n_pct = paste0(pct, ' (', ceiling(n), ')')
    )  |>
    select(!!as.name(row), !!as.name(col), n_pct) |>
    pivot_wider(
      names_from = !!as.name(col),
      values_from = n_pct
    )
  
}

ct_single <- function(var){
  df_list <- purrr::map(anal_vars, ~ct_single_helper(.x, var))
  
  totals <-  households |> 
    count(!!as.name(var), wt = ind_weights) |>
    mutate(Item = 'Total') |> 
    group_by(Item) |>
    mutate(total = sum(n)) |>
    ungroup() |>
    mutate(
      prop = n/total,
      pct = paste0(round(prop * 100, 1), '%')
    ) |>
    mutate(
      n_pct = paste0(pct, ' (', ceiling(n), ')')
    )  |>
    select(Item, !!as.name(var), n_pct) |>
    pivot_wider(
      names_from = !!as.name(var),
      values_from = n_pct
    )
  
  df <- rbind(df_list[[1]] |> rename(Item = strata),
        df_list[[2]] |> rename(Item = age_group),
        df_list[[3]] |> rename(Item = ethnicity),
        df_list[[4]] |> rename(Item = education),
        df_list[[5]] |> rename(Item = workertype_group),
        totals
  )
  
  df[is.na(df)] <- '0% (0)'
  
  df
}

ct_gt <- function(table, tit, sub){
  
  
  table |> 
    gt(rowname_col = 'Item') |> 
    tab_row_group(
      label = md('**Community Type**'),
      rows = 1:2
    ) |> 
    tab_row_group(
      label = md('**Age Group**'),
      rows = 3:5
    ) |> 
    tab_row_group(
      label = md('**Ethnicity**'),
      rows = 6:8
    ) |> 
    tab_row_group(
      label = md('**Education Completed**'),
      rows = 9:11
    ) |> 
    tab_row_group(
      label = md('**Worker Type**'),
      rows = 12:14
    ) |> 
    row_group_order(
      groups = c('**Community Type**', '**Age Group**', '**Education Completed**', '**Ethnicity**')
    ) |> 
    tab_style(
      style = cell_text(align = "left", indent = px(20)),
      locations = cells_stub()
    ) |> 
    tab_header(
      title = tit,
      subtitle = sub
  )
  
}

ct_single_pct <- function(var, national = F){
  
  
  table_strata <- households |> 
    tabyl(strata, !!as.name(var), show_missing_levels = F, show_na = F) |> 
    adorn_totals(c("col")) |> 
    adorn_percentages(c('row')) |> 
    adorn_pct_formatting(digits = 1) |> 
    adorn_ns() |> 
    rename(Item = strata)
  
  table_age <- households |> 
    tabyl(age_group, !!as.name(var), show_missing_levels = F, show_na = F) |> 
    adorn_totals(c("col")) |> 
    adorn_percentages(c('row')) |> 
    adorn_pct_formatting(digits = 1) |> 
    adorn_ns() |> 
    rename(Item = age_group)
  
  table_ethnicity <- households |> 
    tabyl(ethnicity, !!as.name(var), show_missing_levels = F, show_na = F) |> 
    adorn_totals(c("col")) |> 
    adorn_percentages(c('row')) |> 
    adorn_pct_formatting(digits = 1) |> 
    adorn_ns() |> 
    rename(Item = ethnicity)
  
  table_education <- households |> 
    tabyl(education, !!as.name(var), show_missing_levels = F, show_na = F) |> 
    adorn_totals(c("col")) |> 
    adorn_percentages(c('row')) |> 
    adorn_pct_formatting(digits = 1) |> 
    adorn_ns() |> 
    rename(Item = education)
  
  table_worker <- households |> 
    tabyl(workertype_group, !!as.name(var), show_missing_levels = F, show_na = F) |> 
    adorn_totals(c("row", "col")) |> 
    adorn_percentages(c('row')) |> 
    adorn_pct_formatting(digits = 1) |> 
    adorn_ns() |> 
    rename(Item = workertype_group)
  
  
  
  table <- rbind(table_strata, 
                 table_age, 
                 table_education, 
                 table_ethnicity, 
                 table_worker)
  
  table 
  
}


# tabulation functions for multi-select variables

ct_multi <- function(row, col, format = 'pct'){
  
  
  households |> 
    select(all_of(anal_vars), starts_with(col), ind_weights) |> 
    pivot_longer(
      cols = starts_with(col),
      names_to = 'item',
      values_to = 'value'
    ) |> 
    mutate(
      value = as.numeric(value) * ind_weights,
      ind_weights = ind_weights * !is.na(value)
    ) |> 
    group_by(!!as.name(row), item) |> 
    summarise(
      .groups = 'drop',
      selected = ceiling(sum(value, na.rm = T)),
      total = ceiling(sum(ind_weights, na.rm = T)),
      prop = selected/total,
      pct = paste0(round(prop * 100, 1), '%'),
      full = paste0(pct, '(', selected,')')
    ) |>
    select(!!as.name(row), item, full) |> 
    mutate(
      item = stringr::str_replace(item, paste0(col, '_'), '')
    ) |> 
    pivot_wider(
      names_from = item,
      values_from = full
    )
  
}


ct_multi_aggregate <- function(var){
  df_list <- purrr::map(anal_vars, ~ct_multi(.x, var))
  
  rbind(df_list[[1]] |> rename(Item = strata),
        df_list[[2]] |> rename(Item = age_group),
        df_list[[3]] |> rename(Item = ethnicity),
        df_list[[4]] |> rename(Item = education),
        df_list[[5]] |> rename(Item = workertype_group)
  )
}


```

### K1

::: panel-tabset
### Weighted

```{r}
#| echo: false
#| label: k1
#| warning: false

df <- ct_single('k1') 

df |> 
  ct_gt(
    tit = 'Tabulations for question K1',
    sub = 'Have you ever heard about the term environmental conservation?'
  )

```

### Unweighted

```{r}
#| echo: false
#| label: k1-pct
#| warning: false

df <- ct_single_pct('k1')
df |> 
  ct_gt(
    tit = 'Tabulations for question K1',
    sub = 'Have you ever heard about the term environmental conservation?'
  )

```
:::

### K2

```{r}
#| label: k2-prep
#| echo: false

ct_k2_helper <- function(row, k2_var){
  k2 |> 
  filter(k2_roster__id == k2_var) |> 
  mutate(k2_roster__id = as_factor(k2_roster__id)) |> 
  count(!!as.name(row), k2_rate, wt = ind_weights) |> 
  mutate(n = ceiling(n)) |> 
  group_by(!!as.name(row)) |>
  mutate(total = sum(n)) |>
  ungroup() |>
  mutate(
    prop = n/total,
    pct = paste0(round(prop * 100, 1), '%')
  ) |>
  mutate(
    n_pct = paste0(pct, ' (', ceiling(n), ')')
  ) |> 
  select(!!as.name(row), k2_rate, n_pct) |> 
  pivot_wider(names_from = k2_rate, values_from = n_pct) |> 
  select(!!as.name(row), `1`, `2`, `3`, `4`, `5`)
}

ct_k2 <- function(var){
  df_list <- purrr::map(anal_vars, ~ct_k2_helper(.x, var))
  
  totals <- k2 |> 
    filter(k2_roster__id == var) |> 
    mutate(k2_roster__id = as_factor(k2_roster__id)) |> 
    count(k2_rate, wt = ind_weights) |> 
    mutate(Item = 'Total') |> 
    mutate(n = ceiling(n)) |> 
    group_by(Item) |>
    mutate(total = sum(n)) |>
    ungroup() |>
    mutate(
      prop = n/total,
      pct = paste0(round(prop * 100, 1), '%')
    ) |>
    mutate(
      n_pct = paste0(pct, ' (', ceiling(n), ')')
    ) |> 
    select(Item, k2_rate, n_pct) |> 
    pivot_wider(names_from = k2_rate, values_from = n_pct) |> 
    select(Item, `1`, `2`, `3`, `4`, `5`)
  
  
  df <- rbind(df_list[[1]] |> rename(Item = strata),
        df_list[[2]] |> rename(Item = age_group),
        df_list[[3]] |> rename(Item = ethnicity),
        df_list[[4]] |> rename(Item = education),
        df_list[[5]] |> rename(Item = workertype_group),
        totals
  )
  
  df[is.na(df)] <- '0% (0)'
  
  df
}

ct_k2_avg_helper <- function(var){
  k2 |> 
  filter(!is.na(k2_roster__id)) |> 
  mutate(k2_roster__id = as_factor(k2_roster__id)) |> 
  group_by(!!as.name(var), k2_roster__id) |> 
  summarise(
    .groups = 'drop',
    avg = round(mean(k2_rate),2)
  ) |> 
  pivot_wider(
    names_from = k2_roster__id,
    values_from = avg
  )
}


```

::: panel-tabset
### K2.1

```{r}
#| echo: false
ct_k2(1) |> 
  ct_gt(
    tit = 'Tabulations for question K2.1',
    sub = md('On a scale of 1 to 5, with 5 being the highest, how would you rate your knowledge on *Protecting wildlife and nature*')
  )
```

### K2.2

```{r}
#| echo: false
ct_k2(2) |> 
  ct_gt(
    tit = 'Tabulations for question K2.1',
    sub = md('On a scale of 1 to 5, with 5 being the highest, how would you rate your knowledge on *Using Resources Wisely*')
  )
```

### K2.3

```{r}
#| echo: false
ct_k2(3) |> 
  ct_gt(
    tit = 'Tabulations for question K2.1',
    sub = md('On a scale of 1 to 5, with 5 being the highest, how would you rate your knowledge on *Reducing Pollution*')
  )
```

### K2.4

```{r}
#| echo: false
ct_k2(4) |> 
  ct_gt(
    tit = 'Tabulations for question K2.1',
    sub = md('On a scale of 1 to 5, with 5 being the highest, how would you rate your knowledge on *Clean and reusable power*')
  )
```

### K2.5

```{r}
#| echo: false
ct_k2(5) |> 
  ct_gt(
    tit = 'Tabulations for question K2.1',
    sub = md('On a scale of 1 to 5, with 5 being the highest, how would you rate your knowledge on *Habitat Restoration*')
  )
```

### K2.6

```{r}
#| echo: false
ct_k2(6) |> 
  ct_gt(
    tit = 'Tabulations for question K2.1',
    sub = md('On a scale of 1 to 5, with 5 being the highest, how would you rate your knowledge on *Waste Reduction and Recycling*')
  )
```

### K2.7

```{r}
#| echo: false
ct_k2(7) |> 
  ct_gt(
    tit = 'Tabulations for question K2.1',
    sub = md('On a scale of 1 to 5, with 5 being the highest, how would you rate your knowledge on *Education and Advocacy*')
  )

```
:::




### K3

::: panel-tabset
### Weighted

```{r}
#| echo: false
#| label: k3
#| warning: false

df <- ct_single('k3') 

df |> 
  ct_gt(
    tit = 'Tabulations for question K3',
    sub = 'Have you ever heard about the Tapir Mountain Nature Reserve, formerly known as Society Hall Nature Reserve?'
  )
```

### Unweighted

```{r}
#| echo: false
#| label: k3-pct
#| warning: false

df <- ct_single_pct('k3')

df |> 
  ct_gt(
    tit = 'Tabulations for question K3',
    sub = 'Have you ever heard about the Tapir Mountain Nature Reserve, formerly known as Society Hall Nature Reserve?'
  )
```
:::

### K3_1

::: panel-tabset
### Weighted

```{r}
#| echo: false
#| label: k3_1_n
#| warning: false

df <- ct_single('k3_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question K3.1',
    sub = ' Have you heard about a reserve that is located near to this community?'
  )
```

### Unweighted

```{r}
#| echo: false
#| label: k3_1-pct
#| warning: false

df <- ct_single_pct('k3')

df |> 
  ct_gt(
    tit = 'Tabulations for question K3.1',
    sub = ' Have you heard about a reserve that is located near to this community?'
  )

```
:::

### K4

::: panel-tabset
### Weighted

```{r}
#| echo: false
#| label: k4
#| warning: false

df <- ct_multi_aggregate('k4')

df |> 
  select(-`1`) |> 
  ct_gt(
    tit = 'Tabulations for question K4',
    sub = 'What do you know about the Tapir Mountain Nature Reserve?'
  ) |>
  tab_footnote(
    footnote = "Protected Area",
    locations = cells_column_labels(columns = `_1`)
  ) |>
  tab_footnote(
    footnote = "Tourism attraction",
    locations = cells_column_labels(columns = `_2`)
  ) |>
  tab_footnote(
    footnote = "Hunting area",
    locations = cells_column_labels(columns = `_3`)
  ) |>
  tab_footnote(
    footnote = "Logging area",
    locations = cells_column_labels(columns = `_4`)
  ) |>
  tab_footnote(
    footnote = "Other",
    locations = cells_column_labels(columns = `_888888`)
  )  |>
  tab_footnote(
    footnote = "Not Stated",
    locations = cells_column_labels(columns = `_999999`)
  )

```

### Unweighted
:::

### K5

::: panel-tabset
### Weighted

```{r}
#| label: k5
#| echo: false
#| warning: false


df <- ct_single('k5')

df |> 
  rename(
    `No Knowledge` = `No knowledge (does not know any boundaries)`,
    `Some Knowledge` = `Some knowledge (knows where some boundaries lie)`,
    `Strong Knowledge` = `Strong knowledge (is familiar with most/all boundaries)`
  ) |> 
  ct_gt(
    tit = 'Tabulations for question K5',
    sub = 'How would you rate your knowledge of the reserve’s boundaries?'
  )  |>
  tab_footnote(
    footnote = "Does not know any boundaries",
    locations = cells_column_labels(columns = `No Knowledge`)
  )  |>
  tab_footnote(
    footnote = "Knows where some boundaries lie",
    locations = cells_column_labels(columns = `Some Knowledge`)
  )  |>
  tab_footnote(
    footnote = "Is familiar with most/all boundaries",
    locations = cells_column_labels(columns = `Strong Knowledge`)
  )
```

### Unweighted

```{r}
#| label: k5-pct
#| echo: false
#| warning: false


df <- ct_single_pct('k5')

df |> 
  rename(
    `No Knowledge` = `No knowledge (does not know any boundaries)`,
    `Some Knowledge` = `Some knowledge (knows where some boundaries lie)`,
    `Strong Knowledge` = `Strong knowledge (is familiar with most/all boundaries)`
  ) |> 
  ct_gt(
    tit = 'Tabulations for question K5',
    sub = 'How would you rate your knowledge of the reserve’s boundaries?'
  )  |>
  tab_footnote(
    footnote = "Does not know any boundaries",
    locations = cells_column_labels(columns = `No Knowledge`)
  )  |>
  tab_footnote(
    footnote = "Knows where some boundaries lie",
    locations = cells_column_labels(columns = `Some Knowledge`)
  )  |>
  tab_footnote(
    footnote = "Is familiar with most/all boundaries",
    locations = cells_column_labels(columns = `Strong Knowledge`)
  )
```
:::

### K6

::: panel-tabset
### Weighted

```{r}
#| label: k6
#| echo: false
#| warning: false


df <- ct_single('k6')

df |> 
  ct_gt(
    tit = 'Tabulations for question K6',
    sub = 'To your knowledge, who manages the Tapir Mountain Nature Reserve?'
  )  
```

### Unweighted

```{r}
#| label: k6-pct
#| echo: false
#| warning: false


df <- ct_single_pct('k6')

df |> 
  ct_gt(
    tit = 'Tabulations for question K6',
    sub = 'To your knowledge, who manages the Tapir Mountain Nature Reserve?'
  ) 
```
:::

### K7

::: panel-tabset
### Weighted

```{r}
#| label: k7
#| echo: false
#| warning: false


df <- ct_multi_aggregate('k7')

df |> 
  select(-`1`) |> 
  ct_gt(
    tit = 'Tabulations for question K7',
    sub = 'To your knowledge, what responsibilities are involved in managing the (TMNR) reserve?'
  ) |>
  tab_footnote(
    footnote = "Educating the community",
    locations = cells_column_labels(columns = `_1`)
  ) |>
  tab_footnote(
    footnote = "Protecting wildlife in reserve (from hunting, poaching, specie extraction)",
    locations = cells_column_labels(columns = `_2`)
  ) |>
  tab_footnote(
    footnote = "Protecting the natural habitat in the reserve (logging, plant extraction)",
    locations = cells_column_labels(columns = `_3`)
  ) |>
  tab_footnote(
    footnote = "Protecting reserve from natural disaster (flooding, hurricane) and climate change",
    locations = cells_column_labels(columns = `_4`)
  ) |>
  tab_footnote(
    footnote = "Managing license for hunting in the reserve",
    locations = cells_column_labels(columns = `_5`)
  )  |>
  tab_footnote(
    footnote = "Don't Know",
    locations = cells_column_labels(columns = `_7`)
  )  |>
  tab_footnote(
    footnote = "Other",
    locations = cells_column_labels(columns = `_888888`)
  )  |>
  tab_footnote(
    footnote = "Not Stated",
    locations = cells_column_labels(columns = `_999999`)
  )
```

### Unweighted
:::

### K8

::: panel-tabset
### Weighted

```{r}
#| label: k8
#| echo: false
#| warning: false


df <- ct_multi_aggregate('k8__') |> 
  rename(
    `_1` = k8__1,
    `_2` = k8__2,
    `_3` = k8__3,
    `_4` = k8__4,
    `_5` = k8__5,
    `_6` = k8__6,
    `_7` = k8__7,
    `_8` = k8__8,
    `_9` = k8__9,
    `_10` = k8__10,
    `_12` = k8__12,
    `_888888` = k8__888888,
    `_999999` = k8__999999
  ) |> 
  relocate(
   `_10`, `_12`, `_888888`,
   .after = `_9`
  )

df |> 
  ct_gt(
    tit = 'Tabulations for question K8',
    sub = 'To your knowledge, what species of animals live in the Tapir Mountain Nature Reserve?'
  ) |>
  tab_footnote(
    footnote = "Tapir",
    locations = cells_column_labels(columns = `_1`)
  )  |>
  tab_footnote(
    footnote = "Jaguar",
    locations = cells_column_labels(columns = `_2`)
  )  |>
  tab_footnote(
    footnote = "Pumas",
    locations = cells_column_labels(columns = `_3`)
  )  |>
  tab_footnote(
    footnote = "Ocelots/Margay",
    locations = cells_column_labels(columns = `_4`)
  )  |>
  tab_footnote(
    footnote = "Deer",
    locations = cells_column_labels(columns = `_5`)
  )  |>
  tab_footnote(
    footnote = "Peccaries",
    locations = cells_column_labels(columns = `_6`)
  )  |>
  tab_footnote(
    footnote = "Howler and spider monkeys",
    locations = cells_column_labels(columns = `_7`)
  )  |>
  tab_footnote(
    footnote = "Raptors, such as hawks and vultures",
    locations = cells_column_labels(columns = `_8`)
  )  |>
  tab_footnote(
    footnote = "Parrots",
    locations = cells_column_labels(columns = `_9`)
  )  |>
  tab_footnote(
    footnote = "Snakes",
    locations = cells_column_labels(columns = `_10`)
  )  |>
  tab_footnote(
    footnote = "Don't Know",
    locations = cells_column_labels(columns = `_12`)
  )  |>
  tab_footnote(
    footnote = "Other",
    locations = cells_column_labels(columns = `_888888`)
  )  |>
  tab_footnote(
    footnote = "Not Stated",
    locations = cells_column_labels(columns = `_999999`)
  ) 
```

### Unweighted
:::

### K9.1

::: panel-tabset
### Weighted

```{r}
#| label: k9
#| echo: false
#| warning: false


df <- ct_single('k9_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_1',
    sub = 'The water from local wells or pumps comes from the waterbasin or water table in the Tapir Mountain Nature Reserve.'
  ) 
```

### Unweighted

```{r}
#| label: k9-pct
#| echo: false
#| warning: false


df <- ct_single_pct('k9_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_1',
    sub = 'The water from local wells or pumps comes from the waterbasin or water table in the Tapir Mountain Nature Reserve.'
  ) 

```
:::

### K9.2

::: panel-tabset
### Weighted

```{r}
#| label: k9.2
#| echo: false
#| warning: false


df <- ct_single('k9_2')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_2',
    sub = 'People can hunt in the Tapir Mountain Nature Reserve if they have a valid license.'
  ) 
```

### Unweighted

```{r}
#| label: k9.2-pct
#| echo: false
#| warning: false


df <- ct_single_pct('k9_2')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_2',
    sub = 'People can hunt in the Tapir Mountain Nature Reserve if they have a valid license.'
  ) 

```
:::

### 

### K9.3

::: panel-tabset
### Weighted

```{r}
#| label: k9.3
#| echo: false
#| warning: false


df <- ct_single('k9_3')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_3',
    sub = 'The Belize KARST can authorize persons to hunt in the Tapir Mountain Nature Reserve.'
  ) 
```

### Unweighted

```{r}
#| label: k9.3-pct
#| echo: false
#| warning: false


df <- ct_single_pct('k9_3')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_3',
    sub = 'The Belize KARST can authorize persons to hunt in the Tapir Mountain Nature Reserve'
  ) 

```
:::

### 

### K9.4

::: panel-tabset
### Weighted

```{r}
#| label: k9.4
#| echo: false
#| warning: false


df <- ct_single('k9_4')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_4',
    sub = 'The pesticides that people use in their garden/land has a negative impact on water in wells.'
  ) 
```

### Unweighted

```{r}
#| label: k9.4-pct
#| echo: false
#| warning: false


df <- ct_single_pct('k9_4')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_4',
    sub = 'The pesticides that people use in their garden/land has a negative impact on water in wells.'
  ) 

```
:::

### 

### K9.5

::: panel-tabset
### Weighted

```{r}
#| label: k9.5
#| echo: false
#| warning: false


df <- ct_single('k9_5')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_5',
    sub = 'The pesticides that people use in their garden/land has a negative impact on piped water.'
  ) 
```

### Unweighted

```{r}
#| label: k9.5-pct
#| echo: false
#| warning: false


df <- ct_single_pct('k9_5')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_5',
    sub = 'The pesticides that people use in their garden/land has a negative impact on piped water.'
  ) 

```
:::

### 

### K9.6

::: panel-tabset
### Weighted

```{r}
#| label: k9.6
#| echo: false
#| warning: false


df <- ct_single('k9_6')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_6',
    sub = 'Cutting down trees and forests will cause soil to wash away.'
  ) 
```

### Unweighted

```{r}
#| label: k9.6-pct
#| echo: false
#| warning: false


df <- ct_single_pct('k9_6')

df |> 
  ct_gt(
    tit = 'Tabulations for question K9_6',
    sub = 'Cutting down trees and forests will cause soil to wash away.'
  ) 

```
:::

### K10

::: panel-tabset
### Weighted

```{r}
#| label: k10
#| echo: false
#| warning: false


df <- ct_single('k10')

df |> 
  ct_gt(
    tit = 'Tabulations for question K10',
    sub = 'Would your household be interested in learning about breeding native stingless bees for the production of honey?'
  ) 
```

### Unweighted

```{r}
#| label: k10-pct
#| echo: false
#| warning: false


df <- ct_single_pct('k10')

df |> 
  ct_gt(
    tit = 'Tabulations for question K10',
    sub = 'Would your household be interested in learning about breeding native stingless bees for the production of honey?'
  ) 

```
:::

### 

### K11

::: panel-tabset
### Weighted

```{r}
#| label: k11
#| echo: false
#| warning: false


df <- ct_multi_aggregate('k11') 

df |> 
  ct_gt(
    tit = 'Tabulations for question K11',
    sub = 'Have you personally noticed any of the following changes?'
  ) |>
  tab_footnote(
    footnote = "Changes in the rain",
    locations = cells_column_labels(columns = `_1`)
  )  |>
  tab_footnote(
    footnote = "More storms",
    locations = cells_column_labels(columns = `_2`)
  )  |>
  tab_footnote(
    footnote = "Stronger storms",
    locations = cells_column_labels(columns = `_3`)
  )  |>
  tab_footnote(
    footnote = "Change in temperature during day/night",
    locations = cells_column_labels(columns = `_4`)
  )  |>
  tab_footnote(
    footnote = "More flooding",
    locations = cells_column_labels(columns = `_5`)
  )  |>
  tab_footnote(
    footnote = "Loss of soil or erosion",
    locations = cells_column_labels(columns = `_6`)
  ) 

```

### Unweighted

```{r}
#| label: k11-pct
#| echo: false
#| warning: false



```
:::

### 

### K12

::: panel-tabset
### Weighted

```{r}
#| label: k12
#| echo: false
#| warning: false


df <- ct_single('k12')

df |> 
  ct_gt(
    tit = 'Tabulations for question K12',
    sub = 'Have you ever heard that the Earth’s climate, or its weather patterns are changing?'
  ) 
```

### Unweighted

```{r}
#| label: k12-pct
#| echo: false
#| warning: false


df <- ct_single_pct('k12')

df |> 
  ct_gt(
    tit = 'Tabulations for question K12',
    sub = 'Have you ever heard that the Earth’s climate, or its weather patterns are changing?'
  ) 

```
:::

### K13

::: panel-tabset
### Weighted

```{r}
#| label: k13
#| echo: false
#| warning: false


df <- ct_single('k13')

df |> 
  ct_gt(
    tit = 'Tabulations for question K13',
    sub = 'Have you ever heard about the term "Climate Change"?'
  ) 
```

### Unweighted

```{r}
#| label: k13-pct
#| echo: false
#| warning: false


df <- ct_single_pct('k13')

df |> 
  ct_gt(
    tit = 'Tabulations for question K13',
    sub = 'Have you ever heard about the term "Climate Change"?'
  ) 

```
:::

## Attitude Area

### A1.1

::: panel-tabset
### Concern

```{r}
#| label: a1.1
#| echo: false
#| warning: false


df <- ct_single_pct('a1_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question A1.1',
    sub = 'To what extent does waste disposal concern you?'
  ) 
```

### Affect Personally

```{r}
#| label: a2.1
#| echo: false
#| warning: false


df <- ct_single_pct('a2_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question A2.1',
    sub = 'And does water disposal affect you?'
  ) 

```

### Affect TMNR

```{r}
#| label: a3.1
#| echo: false
#| warning: false


df <- ct_single_pct('a3_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question A3.1',
    sub = 'Do you think it affects the Tapir Mountain Nature Reserve?'
  ) 

```
:::

### A1.2

::: panel-tabset
### Concern

```{r}
#| label: a1.2
#| echo: false
#| warning: false


df <- ct_single_pct('a1_2')

df |> 
  ct_gt(
    tit = 'Tabulations for question A1.2',
    sub = 'To what extent does waste contamination concern you?'
  ) 
```

### Affect Personally

```{r}
#| label: a2.2
#| echo: false
#| warning: false


df <- ct_single_pct('a2_2')

df |> 
  ct_gt(
    tit = 'Tabulations for question A2.2',
    sub = 'And does water contamination affect you?'
  ) 

```

### Affect TMNR

```{r}
#| label: a3.2
#| echo: false
#| warning: false


df <- ct_single_pct('a3_2')

df |> 
  ct_gt(
    tit = 'Tabulations for question A3.2',
    sub = 'Do you think it affects the Tapir Mountain Nature Reserve?'
  ) 

```
:::

### A1.3

::: panel-tabset
### Concern

```{r}
#| label: a1.3
#| echo: false
#| warning: false


df <- ct_single_pct('a1_3')

df |> 
  ct_gt(
    tit = 'Tabulations for question A1.3',
    sub = 'To what extent do forest fires concern you?'
  ) 
```

### Affect Personally

```{r}
#| label: a2.3
#| echo: false
#| warning: false


df <- ct_single_pct('a2_3')

df |> 
  ct_gt(
    tit = 'Tabulations for question A2.3',
    sub = 'And do forest fires affect you?'
  ) 

```

### Affect TMNR

```{r}
#| label: a3.3
#| echo: false
#| warning: false


df <- ct_single_pct('a3_3')

df |> 
  ct_gt(
    tit = 'Tabulations for question A3.3',
    sub = 'Do you think it affects the Tapir Mountain Nature Reserve?'
  ) 

```
:::

### A1.4

::: panel-tabset
### Concern

```{r}
#| label: a1.4
#| echo: false
#| warning: false


df <- ct_single_pct('a1_4')

df |> 
  ct_gt(
    tit = 'Tabulations for question A1.4',
    sub = 'To what extent does deforestation concern you?'
  ) 
```

### Affect Personally

```{r}
#| label: a2.4
#| echo: false
#| warning: false


df <- ct_single_pct('a2_4')

df |> 
  ct_gt(
    tit = 'Tabulations for question A2.4',
    sub = 'And does deforestation affect you?'
  ) 

```

### Affect TMNR

```{r}
#| label: a3.4
#| echo: false
#| warning: false


df <- ct_single_pct('a3_4')

df |> 
  ct_gt(
    tit = 'Tabulations for question A3.4',
    sub = 'Do you think it affects the Tapir Mountain Nature Reserve?'
  ) 

```
:::

### A1.5

::: panel-tabset
### Concern

```{r}
#| label: a1.5
#| echo: false
#| warning: false


df <- ct_single_pct('a1_5')

df |> 
  ct_gt(
    tit = 'Tabulations for question A1.5',
    sub = 'To what extent does soil erosion concern you?'
  ) 
```

### Affect Personally

```{r}
#| label: a2.5
#| echo: false
#| warning: false


df <- ct_single_pct('a2_5')

df |> 
  ct_gt(
    tit = 'Tabulations for question A2.5',
    sub = 'And does soil erosion affect you?'
  ) 

```

### Affect TMNR

```{r}
#| label: a3.5
#| echo: false
#| warning: false


df <- ct_single_pct('a3_5')

df |> 
  ct_gt(
    tit = 'Tabulations for question A3.5',
    sub = 'Do you think it affects the Tapir Mountain Nature Reserve?'
  ) 

```
:::

### A1.6

::: panel-tabset
### Concern

```{r}
#| label: a1.6
#| echo: false
#| warning: false


df <- ct_single_pct('a1_6')

df |> 
  ct_gt(
    tit = 'Tabulations for question A1.6',
    sub = 'To what extent does flooding concern you?'
  ) 
```

### Affect Personally

```{r}
#| label: a2.6
#| echo: false
#| warning: false


df <- ct_single_pct('a2_6')

df |> 
  ct_gt(
    tit = 'Tabulations for question A2.6',
    sub = 'And does flooding affect you?'
  ) 

```

### Affect TMNR

```{r}
#| label: a3.6
#| echo: false
#| warning: false


df <- ct_single_pct('a3_6')

df |> 
  ct_gt(
    tit = 'Tabulations for question A3.6',
    sub = 'Do you think it affects the Tapir Mountain Nature Reserve?'
  ) 

```
:::

### A1.7

::: panel-tabset
### Concern

```{r}
#| label: a1.7
#| echo: false
#| warning: false


df <- ct_single_pct('a1_7')

df |> 
  ct_gt(
    tit = 'Tabulations for question A1.7',
    sub = 'To what extent do chemical pesticides concern you?'
  ) 
```

### Affect Personally

```{r}
#| label: a2.7
#| echo: false
#| warning: false


df <- ct_single_pct('a2_7')

df |> 
  ct_gt(
    tit = 'Tabulations for question A2.7',
    sub = 'And do chemical pesticides affect you?'
  ) 

```

### Affect TMNR

```{r}
#| label: a3.7
#| echo: false
#| warning: false


df <- ct_single_pct('a3_7')

df |> 
  ct_gt(
    tit = 'Tabulations for question A3.7',
    sub = 'Do you think it affects the Tapir Mountain Nature Reserve?'
  ) 

```
:::

### A1.8

::: panel-tabset
### Concern

```{r}
#| label: a1.8
#| echo: false
#| warning: false


df <- ct_single_pct('a1_8')

df |> 
  ct_gt(
    tit = 'Tabulations for question A1.8',
    sub = 'To what extent does drought concern you?'
  ) 
```

### Affect Personally

```{r}
#| label: a2.8
#| echo: false
#| warning: false


df <- ct_single_pct('a2_8')

df |> 
  ct_gt(
    tit = 'Tabulations for question A2.8',
    sub = 'And does drought affect you?'
  ) 

```

### Affect TMNR

```{r}
#| label: a3.8
#| echo: false
#| warning: false


df <- ct_single_pct('a3_8')

df |> 
  ct_gt(
    tit = 'Tabulations for question A3.8',
    sub = 'Do you think it affects the Tapir Mountain Nature Reserve?'
  ) 

```
:::

### A1.9

::: panel-tabset
### Concern

```{r}
#| label: a1.9
#| echo: false
#| warning: false


df <- ct_single_pct('a1_9')

df |> 
  ct_gt(
    tit = 'Tabulations for question A1.9',
    sub = 'To what extent does logging concern you?'
  ) 
```

### Affect Personally

```{r}
#| label: a2.9
#| echo: false
#| warning: false


df <- ct_single_pct('a2_9')

df |> 
  ct_gt(
    tit = 'Tabulations for question A2.9',
    sub = 'And does logging affect you?'
  ) 

```

### Affect TMNR

```{r}
#| label: a3.9
#| echo: false
#| warning: false


df <- ct_single_pct('a3_9')

df |> 
  ct_gt(
    tit = 'Tabulations for question A3.9',
    sub = 'Do you think it affects the Tapir Mountain Nature Reserve?'
  ) 

```
:::

### A1.10

::: panel-tabset
### Concern

```{r}
#| label: a1.10
#| echo: false
#| warning: false


df <- ct_single_pct('a1_10')

df |> 
  ct_gt(
    tit = 'Tabulations for question A1.10',
    sub = 'To what extent does hunting of wildlife concern you?'
  ) 
```

### Affect Personally

```{r}
#| label: a2.10
#| echo: false
#| warning: false


df <- ct_single_pct('a2_10')

df |> 
  ct_gt(
    tit = 'Tabulations for question A2.10',
    sub = 'And does hunting of wildlife affect you?'
  ) 

```

### Affect TMNR

```{r}
#| label: a3.10
#| echo: false
#| warning: false


df <- ct_single_pct('a3_10')

df |> 
  ct_gt(
    tit = 'Tabulations for question A3.10',
    sub = 'Do you think it affects the Tapir Mountain Nature Reserve?'
  ) 

```
:::

### A4

::: panel-tabset
### Weighted

```{r}
#| label: a4
#| echo: false
#| warning: false


df <- ct_single('a4')

df |> 
  ct_gt(
    tit = 'Tabulations for question A4',
    sub = 'Do you own livestock or agricultural land in your community?'
  ) 
```

### Unweighted

```{r}
#| label: a4-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a4')

df |> 
  ct_gt(
    tit = 'Tabulations for question K13',
    sub = 'Do you own livestock or agricultural land in your community?'
  ) 

```
:::

### A5

::: panel-tabset
### Weighted

```{r}
#| label: a5
#| echo: false
#| warning: false


df <- ct_single('a5')

df |> 
  ct_gt(
    tit = 'Tabulations for question A5',
    sub = 'Do you feel that your livestock or agricultural land is threatened by predators like jaguars, pumas, from nearby bushes?'
  ) 
```

### Unweighted

```{r}
#| label: a5-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a5')

df |> 
  ct_gt(
    tit = 'Tabulations for question a5',
    sub = 'Do you feel that your livestock or agricultural land is threatened by predators like jaguars, pumas, from nearby bushes?'
  ) 

```
:::

### A6

::: panel-tabset
### Weighted

```{r}
#| label: a6
#| echo: false
#| warning: false


df <- ct_single('a6')

df |> 
  ct_gt(
    tit = 'Tabulations for question A6',
    sub = 'Do you think that jaguars and pumas are currently a threat to your community?'
  ) 
```

### Unweighted

```{r}
#| label: a6-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a6')

df |> 
  ct_gt(
    tit = 'Tabulations for question A6',
    sub = 'Do you think that jaguars and pumas are currently a threat to your community?'
  ) 

```
:::

### A7

::: panel-tabset
### Weighted

```{r}
#| label: a7
#| echo: false
#| warning: false


df <- ct_single('a7')

df |> 
  ct_gt(
    tit = 'Tabulations for question A7',
    sub = 'In your opinion, have human-wildlife conflicts increased, decreased, or remain the same?'
  ) 
```

### Unweighted

```{r}
#| label: a7-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a7')

df |> 
  ct_gt(
    tit = 'Tabulations for question A7',
    sub = 'In your opinion, have human-wildlife conflicts increased, decreased, or remain the same?'
  ) 

```
:::

### A8

::: panel-tabset
### Weighted

```{r}
#| label: a82
#| echo: false
#| warning: false


df <- ct_multi_aggregate('a8') 

df |> 
  select(-`1`) |>
  rename(
    `Report` = `_1`,
    `Scare` = `_2`,
    `Poison or hunt` = `_3`,
    `No action` = `_4`,
    `Other` = `_888888`,
    `Not Stated` = `_999999`
  ) |>
  ct_gt(
    tit = 'Tabulations for question A8',
    sub = 'What would you do if you experienced a conflict with wildlife in your village?'
  ) 
```
:::

### A9

::: panel-tabset
### Weighted

```{r}
#| label: a8
#| echo: false
#| warning: false


df <- ct_multi_aggregate('a9') 

df |> 
  ct_gt(
    tit = 'Tabulations for question A9',
    sub = 'Do you dislike any of the following animals?'
  ) 
```
:::

### A10.1

::: panel-tabset
### Weighted

```{r}
#| label: a10.1
#| echo: false
#| warning: false


df <- ct_single('a10_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.1',
    sub = 'Climate change poses a serious threat for people around the world'
  ) 
```

### Unweighted

```{r}
#| label: a10.1-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a10_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.1',
    sub = 'Climate change poses a serious threat for people around the world'
  ) 

```
:::

### A10.2

::: panel-tabset
### Weighted

```{r}
#| label: a10.2
#| echo: false
#| warning: false


df <- ct_single('a10_2')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.2',
    sub = 'Climate change poses a threat to my livelihood'
  ) 
```

### Unweighted

```{r}
#| label: a10.2-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a10_2')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.2',
    sub = 'Climate change poses a threat to my livelihood'
  ) 

```
:::

### A10.3

::: panel-tabset
### Weighted

```{r}
#| label: a10.3
#| echo: false
#| warning: false


df <- ct_single('a10_3')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.3',
    sub = 'Human activity is greatly responsible for climate change'
  ) 
```

### Unweighted

```{r}
#| label: a10.3-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a10_3')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.3',
    sub = 'Human activity is greatly responsible for climate change'
  ) 

```
:::

### A10.4

::: panel-tabset
### Weighted

```{r}
#| label: a10.4
#| echo: false
#| warning: false


df <- ct_single('a10_4')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.4',
    sub = 'Climate change poses a threat to protected areas'
  ) 
```

### Unweighted

```{r}
#| label: a10.4-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a10_4')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.4',
    sub = 'Climate change poses a threat to protected areas'
  ) 

```
:::

### A10.5

::: panel-tabset
### Weighted

```{r}
#| label: a10.5
#| echo: false
#| warning: false


df <- ct_single('a10_5')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.5',
    sub = 'Slash and burn is a threat to protected areas'
  ) 
```

### Unweighted

```{r}
#| label: a10.5-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a10_5')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.1',
    sub = 'Slash and burn is a threat to protected areas'
  ) 

```
:::

### A10.6

::: panel-tabset
### Weighted

```{r}
#| label: a10.6
#| echo: false
#| warning: false


df <- ct_single('a10_6')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.6',
    sub = 'Establishing protected areas is bad for the community because the land can be used by villagers to provide for their families'
  ) 
```

### Unweighted

```{r}
#| label: a10.6-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a10_6')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.6',
    sub = 'Establishing protected areas is bad for the community because the land can be used by villagers to provide for their families'
  ) 

```
:::

### A10.7

::: panel-tabset
### Weighted

```{r}
#| label: a10.7
#| echo: false
#| warning: false


df <- ct_single('a10_7')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.7',
    sub = 'Our community can benefit from a clean water initiative'
  ) 
```

### Unweighted

```{r}
#| label: a10.7-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a10_7')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.7',
    sub = 'Our community can benefit from a clean water initiative'
  ) 

```
:::

### A10.8

::: panel-tabset
### Weighted

```{r}
#| label: a10.8
#| echo: false
#| warning: false


df <- ct_single('a10_8')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.8',
    sub = 'Our community can benefit from a task force that tackles forest fires'
  ) 
```

### Unweighted

```{r}
#| label: a10.8-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a10_8')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.8',
    sub = 'Our community can benefit from a task force that tackles forest fires'
  ) 

```
:::

### A10.9

::: panel-tabset
### Weighted

```{r}
#| label: a10.9
#| echo: false
#| warning: false


df <- ct_single('a10_9')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.9',
    sub = 'There are job opportunities in tourism in my community'
  ) 
```

### Unweighted

```{r}
#| label: a10.9-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a10_9')

df |> 
  ct_gt(
    tit = 'Tabulations for question A10.9',
    sub = 'There are job opportunities in tourism in my community'
  ) 

```
:::

### A11

::: panel-tabset
### Weighted

```{r}
#| label: a11
#| echo: false
#| warning: false


df <- ct_single('a11')

df |> 
  ct_gt(
    tit = 'Tabulations for question A11',
    sub = 'Do you think that your community could benefit from a neighbourhood watch that reports forest fires, or wildlife hunting in the reserve and the surrounding communities?'
  ) 
```

### Unweighted

```{r}
#| label: a11-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a11')

df |> 
  ct_gt(
    tit = 'Tabulations for question A11',
    sub = 'Do you think that your community could benefit from a neighbourhood watch that reports forest fires, or wildlife hunting in the reserve and the surrounding communities?'
  ) 

```
:::

### A12

::: panel-tabset
### Weighted

```{r}
#| label: a12
#| echo: false
#| warning: false


df <- ct_single('a12')

df |> 
  ct_gt(
    tit = 'Tabulations for question A12',
    sub = 'Would your household be interested in joining a neighbourhood watch?'
  ) 
```

### Unweighted

```{r}
#| label: a12-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a12')

df |> 
  ct_gt(
    tit = 'Tabulations for question A12',
    sub = 'Would your household be interested in joining a neighbourhood watch?'
  ) 

```
:::

### A13

::: panel-tabset
### Weighted

```{r}
#| label: a13
#| echo: false
#| warning: false


df <- ct_single('a13')

df |> 
  ct_gt(
    tit = 'Tabulations for question A13',
    sub = 'Would anyone in your household be interested in receiving training to join a fire task force?'
  ) 
```

### Unweighted

```{r}
#| label: a13-pct
#| echo: false
#| warning: false


df <- ct_single_pct('a13')

df |> 
  ct_gt(
    tit = 'Tabulations for question A13',
    sub = 'Would anyone in your household be interested in receiving training to join a fire task force?'
  ) 

```
:::

## PRACTICE AREA

### P1

::: panel-tabset
### Weighted

```{r}
#| label: p1
#| echo: false
#| warning: false


df <- ct_single('p1')

df |> 
  ct_gt(
    tit = 'Tabulations for question P1',
    sub = 'What is the MAIN way your household disposes of garbage?'
  ) 
```

### Unweighted

```{r}
#| label: p1-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p1')

df |> 
  ct_gt(
    tit = 'Tabulations for question P1',
    sub = 'What is the MAIN way your household disposes of garbage?'
  ) 

```
:::

### P3.1

::: panel-tabset
### Practice

```{r}
#| label: p3.1
#| echo: false
#| warning: false


df <- ct_single_pct('p3_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question P3.1',
    sub = 'Does anyone in your household engage in Gardening?'
  ) 
```

### Frequency

```{r}
#| label: p3.1-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p4_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question P4.1',
    sub = 'How often does your household engage in Gardening?'
  ) 

```
:::

### P3.2

::: panel-tabset
### Practice

```{r}
#| label: p3.2
#| echo: false
#| warning: false


df <- ct_single_pct('p3_2')

df |> 
  ct_gt(
    tit = 'Tabulations for question P3.1',
    sub = 'Does anyone in your household engage in Fishing?'
  ) 
```

### Frequency

```{r}
#| label: p3.2-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p4_2')

df |> 
  ct_gt(
    tit = 'Tabulations for question P4.2',
    sub = 'How often does your household engage in Fishing?'
  ) 

```
:::

### P3.3

::: panel-tabset
### Practice

```{r}
#| label: p3.3
#| echo: false
#| warning: false


df <- ct_single_pct('p3_3')

df |> 
  ct_gt(
    tit = 'Tabulations for question P3.3',
    sub = 'Does anyone in your household engage in Raising Livestock?'
  ) 
```

### Frequency

```{r}
#| label: p3.3-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p4_3')

df |> 
  ct_gt(
    tit = 'Tabulations for question P4.3',
    sub = 'How often does your household engage in Raising Livestock?'
  ) 

```
:::

### P3.4

::: panel-tabset
### Practice

```{r}
#| label: p3.4
#| echo: false
#| warning: false


df <- ct_single_pct('p3_4')

df |> 
  ct_gt(
    tit = 'Tabulations for question P3.4',
    sub = 'Does anyone in your household engage in Hunting?'
  ) 
```

### Frequency

```{r}
#| label: p3.4-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p4_4')

df |> 
  gt() |> 
  tab_header(
    title = 'Tabulations for question P4.4',
    subtitle = 'How often does your household engage in Hunting?'
  ) 

```
:::

### P3.5

::: panel-tabset
### Practice

```{r}
#| label: p3.5
#| echo: false
#| warning: false


df <- ct_single_pct('p3_5')

df |> 
  ct_gt(
    tit = 'Tabulations for question P3.5',
    sub = 'Does anyone in your household engage in Growing Crops?'
  ) 
```

### Frequency

```{r}
#| label: p3.5-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p4_5')

df |> 
  ct_gt(
    tit = 'Tabulations for question P4.5',
    sub = 'How often does your household engage in Growing Crops?'
  ) 

```
:::

### P3.6

::: panel-tabset
### Practice

```{r}
#| label: p3.6
#| echo: false
#| warning: false


df <- ct_single_pct('p3_6')

df |> 
  ct_gt(
    tit = 'Tabulations for question P3.6',
    sub = 'Does anyone in your household engage in Carpentry?'
  ) 
```

### Frequency

```{r}
#| label: p3.6-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p4_6')

df |> 
  gt() |> 
  tab_header(
    title = 'Tabulations for question P4.6',
    subtitle = 'How often does your household engage in Carpentry?'
  ) 

```
:::

### P3.7

::: panel-tabset
### Practice

```{r}
#| label: p3.7
#| echo: false
#| warning: false


df <- ct_single_pct('p3_7')

df |> 
  ct_gt(
    tit = 'Tabulations for question P3.7',
    sub = 'Does anyone in your household engage in Selling Lumber?'
  ) 
```

### Frequency

```{r}
#| label: p3.7-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p4_7')

df |> 
  gt() |> 
  tab_header(
    title = 'Tabulations for question P4.7',
    subtitle = 'How often does your household engage in Selling Lumber?'
  ) 

```
:::


### P5

::: panel-tabset
### Weighted

```{r}
#| label: p5
#| echo: false
#| warning: false


df <- ct_single('p5')

df |> 
  ct_gt(
    tit = 'Tabulations for question P5',
    sub = 'Does your household engage in subsistence farming or agricultural production?'
  ) 
```

### Unweighted

```{r}
#| label: p5-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p5')

df |> 
  ct_gt(
    tit = 'Tabulations for question P5',
    sub = 'Does your household engage in subsistence farming or agricultural production?'
  ) 

```
:::


### P6

::: panel-tabset
### Weighted

```{r}
#| label: p6
#| echo: false
#| warning: false


df <- ct_single('p6')

df |> 
  ct_gt(
    tit = 'Tabulations for question P5',
    sub = 'Would your household be interested in learning environmentally improved crop production crop production methods?'
  ) 
```

### Unweighted

```{r}
#| label: p6-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p6')

df |> 
  ct_gt(
    tit = 'Tabulations for question P6',
    sub = 'Would your household be interested in learning environmentally improved crop production crop production methods?'
  ) 

```
:::


### P7

::: panel-tabset
### Weighted

```{r}
#| label: p7
#| echo: false
#| warning: false


df <- ct_single('p7')

df |> 
  ct_gt(
    tit = 'Tabulations for question P7',
    sub = 'Would your household be interested in learning about biological pesticides?'
  ) 
```

### Unweighted

```{r}
#| label: p7-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p7')

df |> 
  ct_gt(
    tit = 'Tabulations for question P7',
    sub = 'Would your household be interested in learning about biological pesticides?'
  ) 

```
:::

### P8

::: panel-tabset
### Weighted

```{r}
#| label: p8
#| echo: false
#| warning: false


df <- ct_multi_aggregate('p8') 

df |> 
  ct_gt(
    tit = 'Tabulations for question P8',
    sub = 'How do you access news and information on a daily basis?'
  ) 
```
:::


### P9.1

::: panel-tabset
### Weighted

```{r}
#| label: p9.1
#| echo: false
#| warning: false


df <- ct_single('p9_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question P9.1',
    sub = 'How likely are you or your household to engage with promotional advertisement about the Tapir Mountain Nature Reserve on Social Media'
  ) 
```

### Unweighted

```{r}
#| label: p9.1-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p9_1')

df |> 
  ct_gt(
    tit = 'Tabulations for question P9.1',
    sub = 'How likely are you or your household to engage with promotional advertisement about the Tapir Mountain Nature Reserve on Social Media'
  ) 

```
:::


### P9.2

::: panel-tabset
### Weighted

```{r}
#| label: p9.2
#| echo: false
#| warning: false


df <- ct_single('p9_2')

df |> 
  ct_gt(
    tit = 'Tabulations for question P9.2',
    sub = 'How likely are you or your household to engage with promotional advertisement about the Tapir Mountain Nature Reserve on Social Media'
  ) 
```

### Unweighted

```{r}
#| label: p9.2-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p9_2')

df |> 
  ct_gt(
    tit = 'Tabulations for question P9.2',
    sub = 'How likely are you or your household to engage with promotional advertisement about the Tapir Mountain Nature Reserve on Social Media'
  ) 

```
:::


### P9.3

::: panel-tabset
### Weighted

```{r}
#| label: p9.3
#| echo: false
#| warning: false


df <- ct_single('p9_3')

df |> 
  ct_gt(
    tit = 'Tabulations for question P9.3',
    sub = 'How likely are you or your household to engage with promotional advertisement about the Tapir Mountain Nature Reserve on Social Media'
  ) 
```

### Unweighted

```{r}
#| label: p9.3-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p9_3')

df |> 
  ct_gt(
    tit = 'Tabulations for question P9.3',
    sub = 'How likely are you or your household to engage with promotional advertisement about the Tapir Mountain Nature Reserve on Social Media'
  ) 

```
:::


### P9.4

::: panel-tabset
### Weighted

```{r}
#| label: p9.4
#| echo: false
#| warning: false


df <- ct_single('p9_4')

df |> 
  ct_gt(
    tit = 'Tabulations for question P9.4',
    sub = 'How likely are you or your household to engage with promotional advertisement about the Tapir Mountain Nature Reserve on Social Media'
  ) 
```

### Unweighted

```{r}
#| label: p9.4-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p9_4')

df |> 
  ct_gt(
    tit = 'Tabulations for question P9.4',
    sub = 'How likely are you or your household to engage with promotional advertisement about the Tapir Mountain Nature Reserve on Social Media'
  ) 

```
:::



### P10

::: panel-tabset
### Weighted

```{r}
#| label: p10
#| echo: false
#| warning: false


df <- ct_single('p10')

df |> 
  ct_gt(
    tit = 'Tabulations for question P10',
    sub = 'In the past 12 months, has anyone in your household hunted animals from the Tapir Mountain Nature Reserve?'
  ) 
```

### Unweighted

```{r}
#| label: p10-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p10')

df |> 
  ct_gt(
    tit = 'Tabulations for question P10',
    sub = 'In the past 12 months, has anyone in your household hunted animals from the Tapir Mountain Nature Reserve?'
  ) 

```
:::



### P11

::: panel-tabset
### Weighted

```{r}
#| label: p11
#| echo: false
#| warning: false


df <- ct_single('p11')

df |> 
  ct_gt(
    tit = 'Tabulations for question P11',
    sub = 'In the past 12 months, has anyone in your household extracted plants, trees, or logs from the Tapir Mountain Nature Reserve?'
  ) 
```

### Unweighted

```{r}
#| label: p11-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p11')

df |> 
  ct_gt(
    tit = 'Tabulations for question P11',
    sub = 'In the past 12 months, has anyone in your household extracted plants, trees, or logs from the Tapir Mountain Nature Reserve?'
  ) 

```
:::



### P12

::: panel-tabset
### Weighted

```{r}
#| label: p12
#| echo: false
#| warning: false


df <- ct_single('p12')

df |> 
  ct_gt(
    tit = 'Tabulations for question P12',
    sub = 'We don’t want to know their names, but do you know if persons in the community hunted animals or extracted plants, trees, or logs from the Tapir Mountain Nature Reserve within the past 12 months?'
  ) 
```

### Unweighted

```{r}
#| label: p12-pct
#| echo: false
#| warning: false


df <- ct_single_pct('p12')

df |> 
  ct_gt(
    tit = 'Tabulations for question P12',
    sub = 'We don’t want to know their names, but do you know if persons in the community hunted animals or extracted plants, trees, or logs from the Tapir Mountain Nature Reserve within the past 12 months?'
  ) 

```
:::


